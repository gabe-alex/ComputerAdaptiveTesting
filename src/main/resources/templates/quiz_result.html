<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorator="layout">
<head>
    <title>Quiz Result</title>

    <style>
        .panel li {
            list-style: none;
        }

        .glyphicon-ok {
            color: #3c763d;
        }
        .glyphicon-remove {
            color: #a94442;
        }

        .text-bold {
            font-weight: bold;
        }
    </style>
</head>
<body>

<div layout:fragment="content">
    <div class="jumbotron">
        <h1>Result</h1>
    </div>

    <h2>Quiz completed successfully!</h2>
    <h3>Your score is: &nbsp;&nbsp;&nbsp;<b><span th:text="${quizResult.score + '%'}"/></b></h3>
    <!--<p><a th:href="@{/index}">Click here to go back to the main page</a></p>-->
    <div align="center">
        <a th:href="'javascript:share(' + ${quizResult.score} + ',\'' + ${quizResult.quiz.name} + '\');'">
            <img th:src="@{/images/fb_share_button.png}" alt="Share on Facebook"/>
        </a>
    </div>

    <hr/>

    <h3>Results per question:</h3>
    <div th:each="response : ${ongoingQuiz.questionsResponses}" class="panel" th:classappend="${response.isCorrect()}?'panel-success' : 'panel-danger'">
        <div class="panel-heading"><span th:text="${response.question.text}">Question</span><span class="pull-right" th:text="${'Difficulty: '+response.question.score + '/5'}">Score</span></div>
        <div class="panel-body">
            <ul>
                <li th:each="answer : ${response.question.answers}">
                    <span th:if="${response.getSelectedAnswers().contains(answer) and response.question.getCorrectAnswers().contains(answer)}" class="glyphicon glyphicon-ok"></span>
                    <span th:if="${response.getSelectedAnswers().contains(answer) and !response.question.getCorrectAnswers().contains(answer)}" class="glyphicon glyphicon-remove"></span>
                    <span  th:classappend="${response.question.getCorrectAnswers().contains(answer)}?'text-bold' : ''" th:text="${answer.text}"></span>
                </li>
            </ul>
        </div>
    </div>

    <hr/>

    <div align="center">
        <h2 style="text-align: center">Feedback Form</h2>
        <iframe src="https://docs.google.com/forms/d/1JWsaoGHBHaFwy6WgtyHyo2gmENw-MndYKpB1xRf5Rkg/viewform?embedded=true" width="760" height="500" frameborder="0" marginheight="0" marginwidth="0">Loading...</iframe>
    </div>
</div>


<section layout:fragment="scripts" >
    <script>
        window.fbAsyncInit = function() {
            FB.init({
                appId      : '236976676635446',
                xfbml      : true,
                version    : 'v2.6'
            });
        };

        function share(score, domain) {
            FB.ui({
                method: 'feed',
                link: 'https://policat.herokuapp.com',
                name: "I just completed a "+domain+" quiz from PoliCAT!",
                description: "And I got a score of: "+score+"%"
            }, function(response){});
        }

        (function(d, s, id){
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {return;}
            js = d.createElement(s); js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
    </script>
</section>
</body>
</html>