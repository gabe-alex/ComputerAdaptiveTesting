<!DOCTYPE html>
<html xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      xmlns:th="http://www.thymeleaf.org"
      layout:decorator="layout">
<head>
    <title>Adaptive Quiz</title>
    <link href="css/page.css" rel="stylesheet"/>
</head>
<body>

    <div layout:fragment="content">

        <div style="text-align: right"> <h4 style="color:#004669"><b>Time left: <span id="clockdiv"></span></b></h4></div><br/>

        <h3><b><div th:text="${ongoingQuiz.getCurrentQuestion().getText()}"></div></b></h3><hr/>

        <div >
            <form th:action="@{/quiz/question}" method="post" th:object="${ongoingQuiz}">
               <div th:each="answer : ${ongoingQuiz.currentQuestion.answers}">
                 <input type="checkbox" th:field="*{currentSelectedAnswers}" th:value="${answer.id}" />
                  <label th:for="${#ids.prev('currentSelectedAnswers')}" th:text="${answer.text}">Answer</label>
              </div>
                <br/><br/>
                <button type="submit" class="btn btn-primary" value="Next">Next</button>
           </form>


</div>
    </div>


<section layout:fragment="scripts" >
    <script>
        /*<![CDATA[*/
        function getTimeRemaining(endtime){
            var t = new Date(endtime) - new Date();
            var seconds = Math.floor( (t/1000) % 60 );
            var minutes = Math.floor( (t/1000/60) % 60 );
            return {
                'total': t,
                'minutes': minutes,
                'seconds': seconds
            };
        }

        function updateTimer(clock, endtime){
            var t = getTimeRemaining(endtime);
            clock.innerHTML = t.minutes + ' min' +  ' ' +
                    t.seconds + ' sec ';
            if(t.total<=0){
                clearInterval(timeinterval);
            }
        }

        function initializeClock(id, endtime){
            var clock = document.getElementById(id);
            var timeinterval = setInterval(function(){updateTimer(clock, endtime);},1000);
            updateTimer(clock, endtime);
        }
        /*]]>*/
    </script>

    <script th:inline="javascript">
        /*<![CDATA[*/
        var quizEnd = /*[[${ongoingQuiz.endTime.getTime()}]]*/ '0';
        function init() {
            initializeClock('clockdiv', quizEnd);
        }
        window.onload = init;

        /*]]>*/
    </script>
</section>

</body>
</html>